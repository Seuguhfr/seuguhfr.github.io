<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pairwise Comparison Sort</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.5.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
  body {
    font-family: system-ui, sans-serif;
  }
  #raw-list li.compared {
    background-color: #cce5ff;
  }
</style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="mb-4 text-center">Pairwise Comparison Sort</h1>

    <!-- Input form -->
    <form id="input-form" class="input-group mb-3">
      <input id="item-input" type="text" class="form-control" placeholder="Enter an item" autocomplete="off" required />
      <button id="add-btn" class="btn btn-primary" type="submit">Add</button>
    </form>
    <small class="text-muted">Press Enter or click “Add” to append.</small>

    <!-- Raw List -->
    <ul id="raw-list" class="list-group my-4"></ul>

    <!-- Start Sorting -->
    <button id="start-sort" class="btn btn-success" disabled>Start Sorting</button>

    <!-- Result Section -->
    <div id="result-section" class="mt-5 d-none">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h2 class="h5">Sorted List</h2>
        <button id="toggle-order" class="btn btn-outline-secondary btn-sm">Switch to Descending</button>
      </div>
      <ul id="sorted-list" class="list-group"></ul>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="compareModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-center p-4">
        <h5 class="modal-title mb-3">Which comes first?</h5>
        <button id="choiceA" class="btn btn-outline-primary w-100 mb-2"></button>
        <div style="font-size:1.5rem; margin: 8px 0;">vs.</div>
        <button id="choiceB" class="btn btn-outline-primary w-100"></button>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.5.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
(() => {
  const inputForm = document.getElementById('input-form');
  const input = document.getElementById('item-input');
  const addBtn = document.getElementById('add-btn');
  const rawListEl = document.getElementById('raw-list');
  const startSortBtn = document.getElementById('start-sort');
  const resultSection = document.getElementById('result-section');
  const sortedListEl = document.getElementById('sorted-list');
  const toggleBtn = document.getElementById('toggle-order');

  // Modal elements
  const compareModalEl = document.getElementById('compareModal');
  const compareModal = new bootstrap.Modal(compareModalEl);
  const choiceA = document.getElementById('choiceA');
  const choiceB = document.getElementById('choiceB');

  let items = [];
  let sorted = [];
  let asc = true;

  // Sorting state:
  // We'll do insertion sort using pairwise comparison:
  let currentInsertIndex = 1;  // Which item from items we want to insert next into sorted
  let currentCompareIndex = 0; // Position in sorted to compare insertion candidate with
  let insertingItem = null;

  // Render raw list
  function renderRaw() {
    rawListEl.innerHTML = '';
    items.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item;
      li.className = 'list-group-item';
      rawListEl.appendChild(li);
    });
    startSortBtn.disabled = items.length < 2;
  }

  // Render sorted list
  function renderSorted() {
    sortedListEl.innerHTML = '';
    const display = asc ? sorted : [...sorted].reverse();
    display.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item;
      li.className = 'list-group-item';
      sortedListEl.appendChild(li);
    });
    toggleBtn.textContent = asc ? 'Switch to Descending' : 'Switch to Ascending';
  }

  // Start sorting
  function startSorting() {
    sorted = [items[0]];
    currentInsertIndex = 1;
    currentCompareIndex = 0;
    insertingItem = items[currentInsertIndex];
    resultSection.classList.add('d-none');
    startSortBtn.disabled = true;
    addBtn.disabled = true;
    input.disabled = true;
    nextComparison();
  }

  // Show next comparison
  function nextComparison() {
    // Finished inserting all items
    if (currentInsertIndex >= items.length) {
      finishSorting();
      return;
    }

    // If compare index >= sorted length, insert at end
    if (currentCompareIndex >= sorted.length) {
      sorted.push(insertingItem);
      currentInsertIndex++;
      if (currentInsertIndex < items.length) {
        insertingItem = items[currentInsertIndex];
        currentCompareIndex = 0;
        nextComparison();
      } else {
        finishSorting();
      }
      return;
    }

    // Show modal to compare insertingItem vs sorted[currentCompareIndex]
    choiceA.textContent = insertingItem;
    choiceB.textContent = sorted[currentCompareIndex];

    // Highlight items in raw list
    Array.from(rawListEl.children).forEach(li => {
      li.classList.remove('compared');
      if (li.textContent === insertingItem || li.textContent === sorted[currentCompareIndex]) {
        li.classList.add('compared');
      }
    });

    compareModal.show();
  }

  // When user chooses which comes first
  function handleChoice(isAfirst) {
    compareModal.hide();

    if (isAfirst) {
      // Insert insertingItem before sorted[currentCompareIndex]
      sorted.splice(currentCompareIndex, 0, insertingItem);
      currentInsertIndex++;
      if (currentInsertIndex < items.length) {
        insertingItem = items[currentInsertIndex];
        currentCompareIndex = 0;
        nextComparison();
      } else {
        finishSorting();
      }
    } else {
      // Move to next item in sorted to compare
      currentCompareIndex++;
      nextComparison();
    }
  }

  // Finish sorting
  function finishSorting() {
    addBtn.disabled = false;
    input.disabled = false;
    startSortBtn.disabled = false;
    renderSorted();
    resultSection.classList.remove('d-none');

    // Remove highlight
    Array.from(rawListEl.children).forEach(li => li.classList.remove('compared'));
  }

  // Event listeners
  inputForm.addEventListener('submit', e => {
    e.preventDefault();
    const val = input.value.trim();
    if (val === '') return;
    items.push(val);
    input.value = '';
    renderRaw();
  });

  startSortBtn.addEventListener('click', () => {
    if (items.length < 2) return;
    startSorting();
  });

  toggleBtn.addEventListener('click', () => {
    asc = !asc;
    renderSorted();
  });

  choiceA.addEventListener('click', () => handleChoice(true));
  choiceB.addEventListener('click', () => handleChoice(false));

  // Initial render
  renderRaw();
})();
</script>
</body>
</html>
